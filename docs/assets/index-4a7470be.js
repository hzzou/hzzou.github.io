import{f as L,r as b,j as m}from"./index-cc8122ae.js";import{a as E,C as le,O as ce,b as ue,u as me}from"./OrbitControls-b96e8f4a.js";import{V as H,h as q,i as V,j as fe,k as de,l as pe,m as he,Q as ye,n as ge,D as k,o as I,g as xe,p as be,R as Me,q as we,r as ve,s as je,t as Ae,u as ke,v as Se}from"./three.module-d13e5444.js";import{u as T}from"./useGLTF-f45873e9.js";import{P as Pe}from"./PerspectiveCamera-26c77dc6.js";import{_ as F}from"./extends-98964cd2.js";function N(e,n,t={}){const r=new H,i=new ye,c=new H,a=new q,p=new q,g=new q;t.preserveMatrix=t.preserveMatrix!==void 0?t.preserveMatrix:!0,t.preservePosition=t.preservePosition!==void 0?t.preservePosition:!0,t.preserveHipPosition=t.preserveHipPosition!==void 0?t.preserveHipPosition:!1,t.useTargetMatrix=t.useTargetMatrix!==void 0?t.useTargetMatrix:!1,t.hip=t.hip!==void 0?t.hip:"hip",t.names=t.names||{};const v=n.isObject3D?n.skeleton.bones:W(n),x=e.isObject3D?e.skeleton.bones:W(e);let y,o,u,w,f;if(e.isObject3D?e.skeleton.pose():(t.useTargetMatrix=!0,t.preserveMatrix=!1),t.preservePosition){f=[];for(let d=0;d<x.length;d++)f.push(x[d].position.clone())}if(t.preserveMatrix){e.updateMatrixWorld(),e.matrixWorld.identity();for(let d=0;d<e.children.length;++d)e.children[d].updateMatrixWorld(!0)}if(t.offsets){y=[];for(let d=0;d<x.length;++d)o=x[d],u=t.names[o.name]||o.name,t.offsets[u]&&(o.matrix.multiply(t.offsets[u]),o.matrix.decompose(o.position,o.quaternion,o.scale),o.updateMatrixWorld()),y.push(o.matrixWorld.clone())}for(let d=0;d<x.length;++d){if(o=x[d],u=t.names[o.name]||o.name,w=U(u,v),g.copy(o.matrixWorld),w){if(w.updateMatrixWorld(),t.useTargetMatrix?p.copy(w.matrixWorld):(p.copy(e.matrixWorld).invert(),p.multiply(w.matrixWorld)),c.setFromMatrixScale(p),p.scale(c.set(1/c.x,1/c.y,1/c.z)),g.makeRotationFromQuaternion(i.setFromRotationMatrix(p)),e.isObject3D){const j=x.indexOf(o),D=y?y[j]:a.copy(e.skeleton.boneInverses[j]).invert();g.multiply(D)}g.copyPosition(p)}o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(g)):o.matrix.copy(g),t.preserveHipPosition&&u===t.hip&&o.matrix.setPosition(r.set(0,o.position.y,0)),o.matrix.decompose(o.position,o.quaternion,o.scale),o.updateMatrixWorld()}if(t.preservePosition)for(let d=0;d<x.length;++d)o=x[d],u=t.names[o.name]||o.name,u!==t.hip&&o.position.copy(f[d]);t.preserveMatrix&&e.updateMatrixWorld(!0)}function Te(e,n,t,r={}){r.useFirstFramePosition=r.useFirstFramePosition!==void 0?r.useFirstFramePosition:!1,r.fps=r.fps!==void 0?r.fps:30,r.names=r.names||[],n.isObject3D||(n=Oe(n));const i=Math.round(t.duration*(r.fps/1e3)*1e3),c=1/r.fps,a=[],p=new V(n),g=W(e.skeleton),v=[];let x,y,o,u,w;p.clipAction(t).play(),p.update(0),n.updateMatrixWorld();for(let f=0;f<i;++f){const d=f*c;N(e,n,r);for(let j=0;j<g.length;++j)w=r.names[g[j].name]||g[j].name,o=U(w,n.skeleton),o&&(y=g[j],u=v[j]=v[j]||{bone:y},r.hip===w&&(u.pos||(u.pos={times:new Float32Array(i),values:new Float32Array(i*3)}),r.useFirstFramePosition&&(f===0&&(x=y.position.clone()),y.position.sub(x)),u.pos.times[f]=d,y.position.toArray(u.pos.values,f*3)),u.quat||(u.quat={times:new Float32Array(i),values:new Float32Array(i*4)}),u.quat.times[f]=d,y.quaternion.toArray(u.quat.values,f*4));p.update(c),n.updateMatrixWorld()}for(let f=0;f<v.length;++f)u=v[f],u&&(u.pos&&a.push(new fe(".bones["+u.bone.name+"].position",u.pos.times,u.pos.values)),a.push(new de(".bones["+u.bone.name+"].quaternion",u.quat.times,u.quat.values)));return p.uncacheAction(t),new pe(t.name,-1,a)}function Fe(e){const n=new Map,t=new Map,r=e.clone();return J(e,r,function(i,c){n.set(c,i),t.set(i,c)}),r.traverse(function(i){if(!i.isSkinnedMesh)return;const c=i,a=n.get(i),p=a.skeleton.bones;c.skeleton=a.skeleton.clone(),c.bindMatrix.copy(a.bindMatrix),c.skeleton.bones=p.map(function(g){return t.get(g)}),c.bind(c.skeleton,c.bindMatrix)}),r}function U(e,n){for(let t=0,r=W(n);t<r.length;t++)if(e===r[t].name)return r[t]}function W(e){return Array.isArray(e)?e:e.bones}function Oe(e){const n=new he(e.bones[0]);return n.skeleton=e,n}function J(e,n,t){t(e,n);for(let r=0;r<e.children.length;r++)J(e.children[r],n.children[r],t)}const Le={retarget:N,retargetClip:Te,clone:Fe};var Ee=1/0,Ie=9007199254740991,We="[object Arguments]",Be="[object Function]",De="[object GeneratorFunction]",qe="[object Symbol]",Ce=typeof L=="object"&&L&&L.Object===Object&&L,Ge=typeof self=="object"&&self&&self.Object===Object&&self,Re=Ce||Ge||Function("return this")();function ze(e,n,t){switch(t.length){case 0:return e.call(n);case 1:return e.call(n,t[0]);case 2:return e.call(n,t[0],t[1]);case 3:return e.call(n,t[0],t[1],t[2])}return e.apply(n,t)}function He(e,n){for(var t=-1,r=e?e.length:0,i=Array(r);++t<r;)i[t]=n(e[t],t,e);return i}function _e(e,n){for(var t=-1,r=n.length,i=e.length;++t<r;)e[i+t]=n[t];return e}var C=Object.prototype,Ke=C.hasOwnProperty,G=C.toString,_=Re.Symbol,Qe=C.propertyIsEnumerable,K=_?_.isConcatSpreadable:void 0,Q=Math.max;function X(e,n,t,r,i){var c=-1,a=e.length;for(t||(t=Je),i||(i=[]);++c<a;){var p=e[c];n>0&&t(p)?n>1?X(p,n-1,t,r,i):_e(i,p):r||(i[i.length]=p)}return i}function Ve(e,n){return e=Object(e),Ne(e,n,function(t,r){return r in e})}function Ne(e,n,t){for(var r=-1,i=n.length,c={};++r<i;){var a=n[r],p=e[a];t(p,a)&&(c[a]=p)}return c}function Ue(e,n){return n=Q(n===void 0?e.length-1:n,0),function(){for(var t=arguments,r=-1,i=Q(t.length-n,0),c=Array(i);++r<i;)c[r]=t[n+r];r=-1;for(var a=Array(n+1);++r<n;)a[r]=t[r];return a[n]=c,ze(e,this,a)}}function Je(e){return $e(e)||Ye(e)||!!(K&&e&&e[K])}function Xe(e){if(typeof e=="string"||st(e))return e;var n=e+"";return n=="0"&&1/e==-Ee?"-0":n}function Ye(e){return et(e)&&Ke.call(e,"callee")&&(!Qe.call(e,"callee")||G.call(e)==We)}var $e=Array.isArray;function Ze(e){return e!=null&&nt(e.length)&&!tt(e)}function et(e){return Y(e)&&Ze(e)}function tt(e){var n=rt(e)?G.call(e):"";return n==Be||n==De}function nt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ie}function rt(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}function Y(e){return!!e&&typeof e=="object"}function st(e){return typeof e=="symbol"||Y(e)&&G.call(e)==qe}var at=Ue(function(e,n){return e==null?{}:Ve(e,He(X(n,1),Xe))}),ot=at;function it(e,{keys:n=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:t,inject:r,castShadow:i,receiveShadow:c}){let a=ot(e,n);return t&&(a.geometry&&t!=="materialsOnly"&&(a.geometry=a.geometry.clone()),a.material&&t!=="geometriesOnly"&&(a.material=a.material.clone())),r&&(typeof r=="function"?a={...a,children:r(e)}:b.isValidElement(r)?a={...a,children:r}:a={...a,...r}),e instanceof ge&&(i&&(a.castShadow=!0),c&&(a.receiveShadow=!0)),a}const B=b.forwardRef(({isChild:e=!1,object:n,children:t,deep:r,castShadow:i,receiveShadow:c,inject:a,keys:p,...g},v)=>{var x;const y={keys:p,deep:r,inject:a,castShadow:i,receiveShadow:c};if(n=b.useMemo(()=>{if(e===!1&&!Array.isArray(n)){let f=!1;if(n.traverse(d=>{d.isSkinnedMesh&&(f=!0)}),f)return Le.clone(n)}return n},[n,e]),Array.isArray(n))return b.createElement("group",F({},g,{ref:v}),n.map(f=>b.createElement(B,F({key:f.uuid,object:f},y))),t);const{children:o,...u}=it(n,y),w=n.type[0].toLowerCase()+n.type.slice(1);return b.createElement(w,F({},u,g,{ref:v}),((x=n)==null?void 0:x.children).map(f=>f.type==="Bone"?b.createElement("primitive",F({key:f.uuid,object:f},y)):b.createElement(B,F({key:f.uuid,object:f},y,{isChild:!0}))),t,o)}),lt="olympic-hall-",ct={olympic:lt},yt=()=>{const e=new Se,[n,t]=b.useState(0),r=()=>{const{scene:l,camera:s,clock:M}=ue(),A=E(I,"/textures/oly/sky.jpg");return l.background=A,s.lookAt(0,0,0),me(h=>{h.clock.elapsedTime<6&&(h.camera.position.z=300,h.clock.elapsedTime<=5.3?h.camera.position.z-=h.clock.elapsedTime*40:h.camera.position.z=88)}),null},i=T("/models/land.glb"),[c,a]=b.useState({}),p=T("/models/flag.glb"),g=E(I,"/textures/oly/flag.png"),[v,x]=b.useState({});let y;const o=T("/models/bingdwendwen.glb"),[u,w]=b.useState({}),f=T("/models/xuerongrong.glb"),[d,j]=b.useState({}),D=T("/models/tree.gltf"),R=E(I,"/textures/oly/tree.png"),[O,$]=b.useState([]),Z=E(I,"/textures/oly/snow.png"),[S,ee]=b.useState({}),te=()=>{const l=i.scene;l.scale.set(1.5,1.5,1.5),l.position.set(-35,-40,0),l.rotation.set(0,-Math.PI/4,0),l.traverse(s=>{s.type==="Mesh"&&(s.receiveShadow=!0,s.material.metalness=.1,s.material.roughness=.8)}),a(l)},ne=()=>{const l=p.scene;l.traverse(h=>{h.type==="Mesh"&&(h.castShadow=!0,h.name==="mesh_0001"&&(h.material.metalness=.1,h.material.roughness=.1,h.material.map=g),h.name==="柱体"&&(h.material.metalness=.6,h.material.roughness=0,h.material.refractionRatio=1))}),l.rotation.set(0,0,0),l.position.set(10,0,45),l.scale.set(10,10,10);const s=p.animations[0];y=new V(l);let M=s;M=y.clipAction(M).play().getClip(),x(l)},re=()=>{const l=o.scene;l.traverse(s=>{s.type==="Mesh"&&(s.castShadow=!0,s.name==="皮肤"&&(s.material.metalness=.3,s.material.roughness=.8),s.name==="外壳"&&(s.material.transparent=!0,s.material.opacity=.15,s.material.metalness=.6,s.material.roughness=.8,s.material.refractionRatio=1.2,s.castShadow=!0),s.name==="围脖"&&(s.material.transparent=!0,s.material.opacity=.6,s.material.metalness=.4,s.material.roughness=.6))}),l.rotation.set(0,-Math.PI/24,0),l.position.set(-7,-22,54),l.scale.set(44,44,44),w(l)},se=()=>{const l=f.scene;l.traverse(s=>{s.type==="Mesh"&&(s.castShadow=!0)}),l.rotation.set(0,Math.PI/3,0),l.position.set(-30,-18,60),l.scale.set(18,18,18),j(l)},ae=()=>{const l=D.scene;l.traverse(h=>{if(h.type==="Mesh"){h.castShadow=!0;const P=new xe({map:R,transparent:!0,side:k,metalness:.8,roughness:0,depthTest:!0,depthWrite:!1,fog:!1,reflectivity:.1}),ie=new be({depthPacking:Me,map:R});h.material=P,h.custromMaterial=ie}});const s=l.clone();s.position.set(-15,-10,50),s.scale.set(30,30,30);const M=l.clone();M.position.set(15,-15,40),M.scale.set(25,25,25);const A=l.clone();A.position.set(35,-20,55),A.scale.set(30,30,30),$([s,M,A])},oe=()=>{const l=new we,s=new ve({size:1,transparent:!0,opacity:.8,map:Z,blending:je,sizeAttenuation:!0,depthTest:!1}),M=100,A=new Float32Array(1500*3);for(let P=0;P<1500;P++)A[P]=Math.random()*M-M/2;l.center(),l.setAttribute("position",new Ae(A,3));const h=new ke(l,s);ee(h)},z=()=>{const l=e.getDelta();if(y&&y.update(l),JSON.stringify(S)!=="{}"){const s=S.geometry.getAttribute("position");for(let M=0;M<s.array.length;M+=3)s.array[M+1]-=.3,s.array[M+1]<-30&&(s.array[M+1]=30);S.geometry.attributes.position.needsUpdate=!0}if(n<360){const s=e.elapsedTime*.1;t(s)}else t(0);requestAnimationFrame(z)};return b.useEffect(()=>{te(),ae(),ne(),re(),se(),oe()},[]),b.useEffect(()=>{z()},[v,u,d,O,S]),m.jsx("div",{id:ct.olympic,children:m.jsxs(le,{shadows:!0,children:[m.jsx(Pe,{fov:60,near:20,far:500,aspect:window.innerWidth/window.innerHeight,position:[0,0,200]}),m.jsx(ce,{minAzimuthAngle:-Math.PI/12,maxAzimuthAngle:Math.PI/12,minPolarAngle:Math.PI/2,maxPolarAngle:Math.PI/2,maxDistance:110,minDistance:88}),m.jsx(r,{}),m.jsx("ambientLight",{intensity:1,args:["#cfffff"]}),m.jsx("directionalLight",{intensity:1,position:[0,80,200],castShadow:!0,"shadow-camera-top":70,"shadow-camera-bottom":-70,"shadow-camera-left":70,"shadow-camera-right":-70}),m.jsxs("group",{children:[m.jsx("primitive",{object:c}),m.jsx("primitive",{object:S}),m.jsx("primitive",{object:v}),m.jsx("primitive",{object:u}),m.jsx("primitive",{object:d}),m.jsx("primitive",{object:O[0]}),m.jsx(B,{object:O[1]}),m.jsx(B,{object:O[2]}),m.jsxs("group",{position:[0,2,65],"rotation-y":n,children:[m.jsxs("mesh",{castShadow:!0,position:[-10,10,0],children:[m.jsx("torusGeometry",{args:[6,.4,10]}),m.jsx("meshLambertMaterial",{color:"#0885c2",side:k})]}),m.jsxs("mesh",{castShadow:!0,position:[5,10,0],children:[m.jsx("torusGeometry",{args:[6,.4,10]}),m.jsx("meshLambertMaterial",{color:"#000",side:k})]}),m.jsxs("mesh",{castShadow:!0,position:[20,10,0],children:[m.jsx("torusGeometry",{args:[6,.4,10]}),m.jsx("meshLambertMaterial",{color:"#ed334e",side:k})]}),m.jsxs("mesh",{castShadow:!0,position:[-2.5,4,.5],children:[m.jsx("torusGeometry",{args:[6,.4,10]}),m.jsx("meshLambertMaterial",{color:"#fbb132",side:k})]}),m.jsxs("mesh",{castShadow:!0,position:[12,4,.5],children:[m.jsx("torusGeometry",{args:[6,.4,10]}),m.jsx("meshLambertMaterial",{color:"#1c8b3c",side:k})]})]})]})]})})};export{yt as default};
