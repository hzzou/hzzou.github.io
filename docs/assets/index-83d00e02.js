import{f as E,r as b,j as u}from"./index-391f93f7.js";import{a as L,C as ce,O as ue,b as me,u as fe}from"./OrbitControls-d85646c8.js";import{V,h as W,i as N,j as de,k as pe,l as he,m as ye,Q as ge,n as xe,D as A,o as D,g as be,p as Me,R as we,q as ve,r as je,s as Se,t as Ae,u as ke,v as Pe}from"./three.module-d13e5444.js";import{u as T}from"./useGLTF-7c542697.js";import{P as Te}from"./PerspectiveCamera-a4461b72.js";import{_ as F}from"./extends-98964cd2.js";function U(e,r,t={}){const n=new V,i=new ge,c=new V,o=new W,p=new W,y=new W;t.preserveMatrix=t.preserveMatrix!==void 0?t.preserveMatrix:!0,t.preservePosition=t.preservePosition!==void 0?t.preservePosition:!0,t.preserveHipPosition=t.preserveHipPosition!==void 0?t.preserveHipPosition:!1,t.useTargetMatrix=t.useTargetMatrix!==void 0?t.useTargetMatrix:!1,t.hip=t.hip!==void 0?t.hip:"hip",t.names=t.names||{};const j=r.isObject3D?r.skeleton.bones:I(r),g=e.isObject3D?e.skeleton.bones:I(e);let x,s,m,w,f;if(e.isObject3D?e.skeleton.pose():(t.useTargetMatrix=!0,t.preserveMatrix=!1),t.preservePosition){f=[];for(let d=0;d<g.length;d++)f.push(g[d].position.clone())}if(t.preserveMatrix){e.updateMatrixWorld(),e.matrixWorld.identity();for(let d=0;d<e.children.length;++d)e.children[d].updateMatrixWorld(!0)}if(t.offsets){x=[];for(let d=0;d<g.length;++d)s=g[d],m=t.names[s.name]||s.name,t.offsets[m]&&(s.matrix.multiply(t.offsets[m]),s.matrix.decompose(s.position,s.quaternion,s.scale),s.updateMatrixWorld()),x.push(s.matrixWorld.clone())}for(let d=0;d<g.length;++d){if(s=g[d],m=t.names[s.name]||s.name,w=Q(m,j),y.copy(s.matrixWorld),w){if(w.updateMatrixWorld(),t.useTargetMatrix?p.copy(w.matrixWorld):(p.copy(e.matrixWorld).invert(),p.multiply(w.matrixWorld)),c.setFromMatrixScale(p),p.scale(c.set(1/c.x,1/c.y,1/c.z)),y.makeRotationFromQuaternion(i.setFromRotationMatrix(p)),e.isObject3D){const v=g.indexOf(s),R=x?x[v]:o.copy(e.skeleton.boneInverses[v]).invert();y.multiply(R)}y.copyPosition(p)}s.parent&&s.parent.isBone?(s.matrix.copy(s.parent.matrixWorld).invert(),s.matrix.multiply(y)):s.matrix.copy(y),t.preserveHipPosition&&m===t.hip&&s.matrix.setPosition(n.set(0,s.position.y,0)),s.matrix.decompose(s.position,s.quaternion,s.scale),s.updateMatrixWorld()}if(t.preservePosition)for(let d=0;d<g.length;++d)s=g[d],m=t.names[s.name]||s.name,m!==t.hip&&s.position.copy(f[d]);t.preserveMatrix&&e.updateMatrixWorld(!0)}function Fe(e,r,t,n={}){n.useFirstFramePosition=n.useFirstFramePosition!==void 0?n.useFirstFramePosition:!1,n.fps=n.fps!==void 0?n.fps:30,n.names=n.names||[],r.isObject3D||(r=Ee(r));const i=Math.round(t.duration*(n.fps/1e3)*1e3),c=1/n.fps,o=[],p=new N(r),y=I(e.skeleton),j=[];let g,x,s,m,w;p.clipAction(t).play(),p.update(0),r.updateMatrixWorld();for(let f=0;f<i;++f){const d=f*c;U(e,r,n);for(let v=0;v<y.length;++v)w=n.names[y[v].name]||y[v].name,s=Q(w,r.skeleton),s&&(x=y[v],m=j[v]=j[v]||{bone:x},n.hip===w&&(m.pos||(m.pos={times:new Float32Array(i),values:new Float32Array(i*3)}),n.useFirstFramePosition&&(f===0&&(g=x.position.clone()),x.position.sub(g)),m.pos.times[f]=d,x.position.toArray(m.pos.values,f*3)),m.quat||(m.quat={times:new Float32Array(i),values:new Float32Array(i*4)}),m.quat.times[f]=d,x.quaternion.toArray(m.quat.values,f*4));p.update(c),r.updateMatrixWorld()}for(let f=0;f<j.length;++f)m=j[f],m&&(m.pos&&o.push(new de(".bones["+m.bone.name+"].position",m.pos.times,m.pos.values)),o.push(new pe(".bones["+m.bone.name+"].quaternion",m.quat.times,m.quat.values)));return p.uncacheAction(t),new he(t.name,-1,o)}function Oe(e){const r=new Map,t=new Map,n=e.clone();return J(e,n,function(i,c){r.set(c,i),t.set(i,c)}),n.traverse(function(i){if(!i.isSkinnedMesh)return;const c=i,o=r.get(i),p=o.skeleton.bones;c.skeleton=o.skeleton.clone(),c.bindMatrix.copy(o.bindMatrix),c.skeleton.bones=p.map(function(y){return t.get(y)}),c.bind(c.skeleton,c.bindMatrix)}),n}function Q(e,r){for(let t=0,n=I(r);t<n.length;t++)if(e===n[t].name)return n[t]}function I(e){return Array.isArray(e)?e:e.bones}function Ee(e){const r=new ye(e.bones[0]);return r.skeleton=e,r}function J(e,r,t){t(e,r);for(let n=0;n<e.children.length;n++)J(e.children[n],r.children[n],t)}const Le={retarget:U,retargetClip:Fe,clone:Oe};var De=1/0,Ie=9007199254740991,Be="[object Arguments]",Re="[object Function]",We="[object GeneratorFunction]",_e="[object Symbol]",qe=typeof E=="object"&&E&&E.Object===Object&&E,Ce=typeof self=="object"&&self&&self.Object===Object&&self,Ge=qe||Ce||Function("return this")();function Ve(e,r,t){switch(t.length){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}function ze(e,r){for(var t=-1,n=e?e.length:0,i=Array(n);++t<n;)i[t]=r(e[t],t,e);return i}function He(e,r){for(var t=-1,n=r.length,i=e.length;++t<n;)e[i+t]=r[t];return e}var _=Object.prototype,Ke=_.hasOwnProperty,q=_.toString,z=Ge.Symbol,Ne=_.propertyIsEnumerable,H=z?z.isConcatSpreadable:void 0,K=Math.max;function X(e,r,t,n,i){var c=-1,o=e.length;for(t||(t=Xe),i||(i=[]);++c<o;){var p=e[c];r>0&&t(p)?r>1?X(p,r-1,t,n,i):He(i,p):n||(i[i.length]=p)}return i}function Ue(e,r){return e=Object(e),Qe(e,r,function(t,n){return n in e})}function Qe(e,r,t){for(var n=-1,i=r.length,c={};++n<i;){var o=r[n],p=e[o];t(p,o)&&(c[o]=p)}return c}function Je(e,r){return r=K(r===void 0?e.length-1:r,0),function(){for(var t=arguments,n=-1,i=K(t.length-r,0),c=Array(i);++n<i;)c[n]=t[r+n];n=-1;for(var o=Array(r+1);++n<r;)o[n]=t[n];return o[r]=c,Ve(e,this,o)}}function Xe(e){return Ze(e)||$e(e)||!!(H&&e&&e[H])}function Ye(e){if(typeof e=="string"||at(e))return e;var r=e+"";return r=="0"&&1/e==-De?"-0":r}function $e(e){return tt(e)&&Ke.call(e,"callee")&&(!Ne.call(e,"callee")||q.call(e)==Be)}var Ze=Array.isArray;function et(e){return e!=null&&nt(e.length)&&!rt(e)}function tt(e){return Y(e)&&et(e)}function rt(e){var r=st(e)?q.call(e):"";return r==Re||r==We}function nt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ie}function st(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function Y(e){return!!e&&typeof e=="object"}function at(e){return typeof e=="symbol"||Y(e)&&q.call(e)==_e}var ot=Je(function(e,r){return e==null?{}:Ue(e,ze(X(r,1),Ye))}),it=ot;function lt(e,{keys:r=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:t,inject:n,castShadow:i,receiveShadow:c}){let o=it(e,r);return t&&(o.geometry&&t!=="materialsOnly"&&(o.geometry=o.geometry.clone()),o.material&&t!=="geometriesOnly"&&(o.material=o.material.clone())),n&&(typeof n=="function"?o={...o,children:n(e)}:b.isValidElement(n)?o={...o,children:n}:o={...o,...n}),e instanceof xe&&(i&&(o.castShadow=!0),c&&(o.receiveShadow=!0)),o}const B=b.forwardRef(({isChild:e=!1,object:r,children:t,deep:n,castShadow:i,receiveShadow:c,inject:o,keys:p,...y},j)=>{var g;const x={keys:p,deep:n,inject:o,castShadow:i,receiveShadow:c};if(r=b.useMemo(()=>{if(e===!1&&!Array.isArray(r)){let f=!1;if(r.traverse(d=>{d.isSkinnedMesh&&(f=!0)}),f)return Le.clone(r)}return r},[r,e]),Array.isArray(r))return b.createElement("group",F({},y,{ref:j}),r.map(f=>b.createElement(B,F({key:f.uuid,object:f},x))),t);const{children:s,...m}=lt(r,x),w=r.type[0].toLowerCase()+r.type.slice(1);return b.createElement(w,F({},m,y,{ref:j}),((g=r)==null?void 0:g.children).map(f=>f.type==="Bone"?b.createElement("primitive",F({key:f.uuid,object:f},x)):b.createElement(B,F({key:f.uuid,object:f},x,{isChild:!0}))),t,s)}),ct="olympic-hall-",ut={olympic:ct},gt=()=>{const e=new Pe,[r,t]=b.useState(0),{VITE_BASE_URL:n}={VITE_NODE_ENV:"production",VITE_BASE_URL:"/react-three",BASE_URL:"/react-three",MODE:"production",DEV:!1,PROD:!0,SSR:!1},i=()=>{const{scene:l,camera:a,clock:M}=me(),S=L(D,"/textures/oly/sky.jpg");return l.background=S,a.lookAt(0,0,0),fe(h=>{h.clock.elapsedTime<6&&(h.camera.position.z=300,h.clock.elapsedTime<=5.3?h.camera.position.z-=h.clock.elapsedTime*40:h.camera.position.z=88)}),null},c=T(n+"models/land.glb"),[o,p]=b.useState({}),y=T(n+"models/flag.glb"),j=L(D,n+"textures/oly/flag.png"),[g,x]=b.useState({});let s;const m=T(n+"models/bingdwendwen.glb"),[w,f]=b.useState({}),d=T(n+"models/xuerongrong.glb"),[v,R]=b.useState({}),$=T(n+"models/tree.gltf"),C=L(D,n+"textures/oly/tree.png"),[O,Z]=b.useState([]),ee=L(D,n+"textures/oly/snow.png"),[k,te]=b.useState({}),re=()=>{const l=c.scene;l.scale.set(1.5,1.5,1.5),l.position.set(-35,-40,0),l.rotation.set(0,-Math.PI/4,0),l.traverse(a=>{a.type==="Mesh"&&(a.receiveShadow=!0,a.material.metalness=.1,a.material.roughness=.8)}),p(l)},ne=()=>{const l=y.scene;l.traverse(h=>{h.type==="Mesh"&&(h.castShadow=!0,h.name==="mesh_0001"&&(h.material.metalness=.1,h.material.roughness=.1,h.material.map=j),h.name==="柱体"&&(h.material.metalness=.6,h.material.roughness=0,h.material.refractionRatio=1))}),l.rotation.set(0,0,0),l.position.set(10,0,45),l.scale.set(10,10,10);const a=y.animations[0];s=new N(l);let M=a;M=s.clipAction(M).play().getClip(),x(l)},se=()=>{const l=m.scene;l.traverse(a=>{a.type==="Mesh"&&(a.castShadow=!0,a.name==="皮肤"&&(a.material.metalness=.3,a.material.roughness=.8),a.name==="外壳"&&(a.material.transparent=!0,a.material.opacity=.15,a.material.metalness=.6,a.material.roughness=.8,a.material.refractionRatio=1.2,a.castShadow=!0),a.name==="围脖"&&(a.material.transparent=!0,a.material.opacity=.6,a.material.metalness=.4,a.material.roughness=.6))}),l.rotation.set(0,-Math.PI/24,0),l.position.set(-7,-22,54),l.scale.set(44,44,44),f(l)},ae=()=>{const l=d.scene;l.traverse(a=>{a.type==="Mesh"&&(a.castShadow=!0)}),l.rotation.set(0,Math.PI/3,0),l.position.set(-30,-18,60),l.scale.set(18,18,18),R(l)},oe=()=>{const l=$.scene;l.traverse(h=>{if(h.type==="Mesh"){h.castShadow=!0;const P=new be({map:C,transparent:!0,side:A,metalness:.8,roughness:0,depthTest:!0,depthWrite:!1,fog:!1,reflectivity:.1}),le=new Me({depthPacking:we,map:C});h.material=P,h.custromMaterial=le}});const a=l.clone();a.position.set(-15,-10,50),a.scale.set(30,30,30);const M=l.clone();M.position.set(15,-15,40),M.scale.set(25,25,25);const S=l.clone();S.position.set(35,-20,55),S.scale.set(30,30,30),Z([a,M,S])},ie=()=>{const l=new ve,a=new je({size:1,transparent:!0,opacity:.8,map:ee,blending:Se,sizeAttenuation:!0,depthTest:!1}),M=100,S=new Float32Array(1500*3);for(let P=0;P<1500;P++)S[P]=Math.random()*M-M/2;l.center(),l.setAttribute("position",new Ae(S,3));const h=new ke(l,a);te(h)},G=()=>{const l=e.getDelta();if(s&&s.update(l),JSON.stringify(k)!=="{}"){const a=k.geometry.getAttribute("position");for(let M=0;M<a.array.length;M+=3)a.array[M+1]-=.3,a.array[M+1]<-30&&(a.array[M+1]=30);k.geometry.attributes.position.needsUpdate=!0}if(r<360){const a=e.elapsedTime*.1;t(a)}else t(0);requestAnimationFrame(G)};return b.useEffect(()=>{re(),oe(),ne(),se(),ae(),ie()},[]),b.useEffect(()=>{G()},[g,w,v,O,k]),u.jsx("div",{id:ut.olympic,children:u.jsxs(ce,{shadows:!0,children:[u.jsx(Te,{fov:60,near:20,far:500,aspect:window.innerWidth/window.innerHeight,position:[0,0,200]}),u.jsx(ue,{minAzimuthAngle:-Math.PI/12,maxAzimuthAngle:Math.PI/12,minPolarAngle:Math.PI/2,maxPolarAngle:Math.PI/2,maxDistance:110,minDistance:88}),u.jsx(i,{}),u.jsx("ambientLight",{intensity:1,args:["#cfffff"]}),u.jsx("directionalLight",{intensity:1,position:[0,80,200],castShadow:!0,"shadow-camera-top":70,"shadow-camera-bottom":-70,"shadow-camera-left":70,"shadow-camera-right":-70}),u.jsxs("group",{children:[u.jsx("primitive",{object:o}),u.jsx("primitive",{object:k}),u.jsx("primitive",{object:g}),u.jsx("primitive",{object:w}),u.jsx("primitive",{object:v}),u.jsx("primitive",{object:O[0]}),u.jsx(B,{object:O[1]}),u.jsx(B,{object:O[2]}),u.jsxs("group",{position:[0,2,65],"rotation-y":r,children:[u.jsxs("mesh",{castShadow:!0,position:[-10,10,0],children:[u.jsx("torusGeometry",{args:[6,.4,10]}),u.jsx("meshLambertMaterial",{color:"#0885c2",side:A})]}),u.jsxs("mesh",{castShadow:!0,position:[5,10,0],children:[u.jsx("torusGeometry",{args:[6,.4,10]}),u.jsx("meshLambertMaterial",{color:"#000",side:A})]}),u.jsxs("mesh",{castShadow:!0,position:[20,10,0],children:[u.jsx("torusGeometry",{args:[6,.4,10]}),u.jsx("meshLambertMaterial",{color:"#ed334e",side:A})]}),u.jsxs("mesh",{castShadow:!0,position:[-2.5,4,.5],children:[u.jsx("torusGeometry",{args:[6,.4,10]}),u.jsx("meshLambertMaterial",{color:"#fbb132",side:A})]}),u.jsxs("mesh",{castShadow:!0,position:[12,4,.5],children:[u.jsx("torusGeometry",{args:[6,.4,10]}),u.jsx("meshLambertMaterial",{color:"#1c8b3c",side:A})]})]})]})]})})};export{gt as default};
