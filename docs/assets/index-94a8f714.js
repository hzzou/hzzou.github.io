import{r as c,u as d,j as u}from"./index-189c03b4.js";import{s as f,r as h}from"./hox-root-7a58eb18.js";import{B as b}from"./button-eea685af.js";import"./index-23684823.js";import"./extends-4c19d496.js";class m{constructor(e){this.hook=e,this.subscribers=new Set}notify(){for(const e of this.subscribers)e(this.data)}}function p(t,e){var r;const n=c.useRef(e);n.current=e;const s=c.useRef(((r=n.current)===null||r===void 0?void 0:r.call(n,t.data))||[]);return f.useSyncExternalStore(a=>{function o(){if(!n.current)a();else{const l=s.current,i=n.current(t.data);S(l,i)&&a(),s.current=i}}return t.subscribers.add(o),()=>{t.subscribers.delete(o)}},()=>t.data)}function S(t,e){if(t.length!==e.length)return!0;for(const r in e)if(t[r]!==e[r])return!0;return!1}function x(t){let e=null;function r(){if(!e)throw new Error("Failed to retrieve data from global container. Please make sure you have rendered HoxRoot.");return e}const n=c.memo(()=>{const[o]=c.useState(()=>new m(t));return e=o,o.data=t(),c.useEffect(()=>{o.notify()}),null});h(n);function s(o){return p(r(),o)}function a(){return r().data}return[s,a]}const g=(t,e)=>{switch(e.type){case"ADD":return{count:t.count+1,age:t.age};case"SUB":return{count:t.count>0?t.count-1:0,age:t.age};case"RESET":return{count:e.payload?e.payload:0,age:t.age}}},v=()=>{const[t,e]=c.useReducer(g,{count:0,age:25});return[t,e]},[E]=x(()=>{const[t,e]=v();return{countState:t,countDispatch:e}}),G=()=>{const t=d(),{countState:e,countDispatch:r}=E(),n=()=>{t("/home")},s=()=>{r({type:"SUB"})};return u.jsxs("div",{className:"home-detail",children:[u.jsx("div",{children:e.count}),u.jsx(b,{onClick:s,children:"reducer共享"}),u.jsx("div",{children:"homeDetail"}),u.jsx("div",{onClick:n,children:"返回"})]})};export{G as default};
